(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{102:function(e,t,n){},126:function(e,t,n){"use strict";n.r(t);var r,a,c,s,o,i,l,d,j,b=n(0),m=n.n(b),u=n(83),h=n.n(u),p=(n(102),n(14)),x=n(92),O=n(135),g=n(137),v=n(134),f=n(90),y=n(10),N=n(12),w=n(138),k=n(2),S=function(e){var t=e.reports,n=e.title,r=e.showTitle,a=void 0===r||r,c=e.showUsername,s=void 0===c||c;return t.length?Object(k.jsxs)("div",{children:[a&&Object(k.jsx)("h3",{children:n}),t&&t.map((function(e){return Object(k.jsxs)("div",{className:"card mb-3",children:[Object(k.jsx)("h4",{className:"card-header bg-primary text-light p-2 m-0",children:s?Object(k.jsxs)(y.b,{className:"text-light",to:"/profiles/".concat(e.reportAuthor),children:[e.reportAuthor," ",Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{fontSize:"1rem"},children:["had this report on ",e.createdAt]})]}):Object(k.jsx)(k.Fragment,{children:Object(k.jsxs)("span",{style:{fontSize:"1rem"},children:["You had this report on ",e.createdAt]})})}),Object(k.jsx)("div",{className:"card-body bg-light p-2",children:Object(k.jsx)("p",{children:e.reporText})}),Object(k.jsx)(y.b,{className:"btn btn-primary btn-block btn-squared",to:"/reports/".concat(e._id),children:"View report of this pet."})]},e._id)}))]}):Object(k.jsx)("h3",{children:"No Reports Yet"})},I=n(20),T=n.n(I),A=n(31),_=n(37),C=n(6),P=n(140),$=n(30),R=n(136),z=Object(R.a)(r||(r=Object($.a)(["\n  mutation login($email: String!, $password: String!) {\n    login(email: $email, password: $password) {\n      token\n      user {\n        _id\n        username\n      }\n    }\n  }\n"]))),Y=Object(R.a)(a||(a=Object($.a)(["\n  mutation addUser($username: String!, $email: String!, $password: String!) {\n    addUser(username: $username, email: $email, password: $password) {\n      token\n      user {\n        _id\n        username\n      }\n    }\n  }\n"]))),F=Object(R.a)(c||(c=Object($.a)(["\n  mutation addReport($reportText: String!) {\n    addReport(reportText: $reportText) {\n      _id\n      reportText\n      reportAuthor\n      createdAt\n      comments {\n        _id\n        commentText\n      }\n    }\n  }\n"]))),D=(Object(R.a)(s||(s=Object($.a)(["\n  mutation addLostPetProfile($lostPetName: String) {\n    addLostPetProfile(lostPetName: $lostPetName) {\n      _id\n      lostPetAuthor\n      lostPetName\n      createdAt\n    }\n  }\n"]))),Object(R.a)(o||(o=Object($.a)(["\n  mutation addComment($reportId: ID!, $commentText: String!) {\n    addComment(reportId: $reportId, commentText: $commentText) {\n      _id\n      reportText\n      reportAuthor\n      createdAt\n      comments {\n        _id\n        commentText\n        createdAt\n      }\n    }\n  }\n"])))),J=Object(R.a)(i||(i=Object($.a)(["\n  query user($username: String!) {\n    user(username: $username) {\n      _id\n      username\n      email\n      reports {\n        _id\n        reportText\n        createdAt\n      }\n    }\n  }\n"]))),L=Object(R.a)(l||(l=Object($.a)(["\n  query getReports {\n    reports {\n      _id\n      reportText\n      reportAuthor\n      createdAt\n    }\n  }\n"]))),M=Object(R.a)(d||(d=Object($.a)(["\n  query getSingleReport($reportId: ID!) {\n    report(reportId: $reportId) {\n      _id\n      reportText\n      reportAuthor\n      createdAt\n      comments {\n        _id\n        commentText\n        commentAuthor\n        createdAt\n      }\n    }\n  }\n"]))),q=Object(R.a)(j||(j=Object($.a)(["\n  query me {\n    me {\n      _id\n      username\n      email\n      reports {\n        _id\n        reportText\n        reportAuthor\n        createdAt\n      }\n    }\n  }\n"]))),U=n(15),Z=n(16),H=n(66),V=new(function(){function e(){Object(U.a)(this,e)}return Object(Z.a)(e,[{key:"getProfile",value:function(){return Object(H.a)(this.getToken())}},{key:"loggedIn",value:function(){var e=this.getToken();return!(!e||this.isTokenExpired(e))}},{key:"isTokenExpired",value:function(e){return Object(H.a)(e).exp<Date.now()/1e3&&(localStorage.removeItem("id_token"),!0)}},{key:"getToken",value:function(){return localStorage.getItem("id_token")}},{key:"login",value:function(e){localStorage.setItem("id_token",e),window.location.assign("/")}},{key:"logout",value:function(){localStorage.removeItem("id_token"),window.location.reload()}}]),e}()),B=function(){var e=Object(b.useState)(""),t=Object(C.a)(e,2),n=t[0],r=t[1],a=Object(b.useState)(0),c=Object(C.a)(a,2),s=c[0],o=c[1],i=Object(P.a)(F,{update:function(e,t){var n=t.data.addReport;try{var r=e.readQuery({query:L}).reports;e.writeQuery({query:L,data:{reports:[n].concat(Object(_.a)(r))}})}catch(c){console.error(c)}var a=e.readQuery({query:q}).me;e.writeQuery({query:q,data:{me:Object(p.a)(Object(p.a)({},a),{},{reports:[].concat(Object(_.a)(a.reports),[n])})}})}}),l=Object(C.a)(i,2),d=l[0],j=l[1].error,m=function(){var e=Object(A.a)(T.a.mark((function e(t){var a;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,d({variables:{reportText:n,reportAuthor:V.getProfile().data.username}});case 4:a=e.sent,a.data,r(""),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(k.jsxs)("div",{children:[Object(k.jsx)("h3",{children:"Search for your pet based on your location"}),V.loggedIn()?Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)("p",{className:"m-0 ".concat(280===s||j?"text-danger":""),children:["Character Count: ",s,"/280"]}),Object(k.jsxs)("form",{className:"flex-row justify-center justify-space-between-md align-center",onSubmit:m,children:[Object(k.jsx)("div",{className:"col-12 col-lg-9",children:Object(k.jsx)("textarea",{name:"reportText",placeholder:"Here's a new report...",value:n,className:"form-input w-100",style:{lineHeight:"1.5",resize:"vertical"},onChange:function(e){var t=e.target,n=t.name,a=t.value;"reportText"===n&&a.length<=280&&(r(a),o(a.length))}})}),Object(k.jsx)("div",{className:"col-12 col-lg-3",children:Object(k.jsx)("button",{className:"btn btn-primary btn-block py-3",type:"submit",children:"Add Report"})}),j&&Object(k.jsx)("div",{className:"col-12 my-3 bg-danger text-white p-3",children:j.message})]})]}):Object(k.jsxs)("p",{children:["You need to be logged in to view local lost pet reports. Please"," ",Object(k.jsx)(y.b,{to:"/login",children:"login"})," or ",Object(k.jsx)(y.b,{to:"/signup",children:"signup."})]})]})},E=n(91),Q=n(54);function W(){var e=Object(b.useState)({latitude:37.7577,longitude:-122.4376,zoom:8,width:window.innerWidth,height:window.innerHeight}),t=Object(C.a)(e,2),n=t[0],r=t[1];return Object(k.jsx)(E.a,Object(p.a)(Object(p.a)({mapboxApiAccessToken:"pk.eyJ1Ijoia3Jpc3R5Z3VlcnJlcm8yMCIsImEiOiJja3Vob2U1MnYyZmxvMndvOHIzMzNzMnZiIn0.WY_nDAowRmL88PNZs7iJRw"},n),{},{onViewportChange:function(e){return r(e)}}))}n.n(Q).a.accessToken="pk.eyJ1Ijoia3Jpc3R5Z3VlcnJlcm8yMCIsImEiOiJja3Vob2U1MnYyZmxvMndvOHIzMzNzMnZiIn0.WY_nDAowRmL88PNZs7iJRw";var G=function(){var e=Object(w.a)(L),t=e.loading,n=e.data,r=(null===n||void 0===n?void 0:n.reports)||[];return Object(k.jsx)("main",{children:Object(k.jsxs)("div",{className:"flex-row justify-center",children:[Object(k.jsxs)("div",{className:"col-12 col-md-10 mb-3 p-3",style:{border:"1px dotted #1a1a1a"},children:[Object(k.jsx)(B,{}),Object(k.jsx)(W,{})]}),Object(k.jsx)("div",{className:"col-12 col-md-8 mb-3",children:t?Object(k.jsx)("div",{children:"Loading..."}):Object(k.jsx)(S,{reports:r,title:"Recent lost pet reports"})})]})})},K=n(43),X=function(){var e=Object(b.useState)({username:"",email:"",password:""}),t=Object(C.a)(e,2),n=t[0],r=t[1],a=Object(P.a)(Y),c=Object(C.a)(a,2),s=c[0],o=c[1],i=o.error,l=o.data,d=function(e){var t=e.target,a=t.name,c=t.value;r(Object(p.a)(Object(p.a)({},n),{},Object(K.a)({},a,c)))},j=function(){var e=Object(A.a)(T.a.mark((function e(t){var r,a;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),console.log(n),e.prev=2,e.next=5,s({variables:Object(p.a)({},n)});case 5:r=e.sent,a=r.data,V.login(a.addUser.token),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(k.jsx)("main",{className:"flex-row justify-center mb-4",children:Object(k.jsx)("div",{className:"col-12 col-lg-10",children:Object(k.jsxs)("div",{className:"card",children:[Object(k.jsx)("h4",{className:"card-header bg-dark text-light p-2",children:"Sign Up"}),Object(k.jsxs)("div",{className:"card-body",children:[l?Object(k.jsxs)("p",{children:["Success! You may now head"," ",Object(k.jsx)(y.b,{to:"/",children:"back to the homepage."})]}):Object(k.jsxs)("form",{onSubmit:j,children:[Object(k.jsx)("input",{className:"form-input",placeholder:"Your username",name:"username",type:"text",value:n.name,onChange:d}),Object(k.jsx)("input",{className:"form-input",placeholder:"Your email",name:"email",type:"email",value:n.email,onChange:d}),Object(k.jsx)("input",{className:"form-input",placeholder:"******",name:"password",type:"password",value:n.password,onChange:d}),Object(k.jsx)("button",{className:"btn btn-block btn-primary",style:{cursor:"pointer"},type:"submit",children:"Submit"})]}),i&&Object(k.jsx)("div",{className:"my-3 p-3 bg-danger text-white",children:i.message})]})]})})})},ee=function(e){var t=Object(b.useState)({email:"",password:""}),n=Object(C.a)(t,2),r=n[0],a=n[1],c=Object(P.a)(z),s=Object(C.a)(c,2),o=s[0],i=s[1],l=i.error,d=i.data,j=function(e){var t=e.target,n=t.name,c=t.value;a(Object(p.a)(Object(p.a)({},r),{},Object(K.a)({},n,c)))},m=function(){var e=Object(A.a)(T.a.mark((function e(t){var n,c;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),console.log(r),e.prev=2,e.next=5,o({variables:Object(p.a)({},r)});case 5:n=e.sent,c=n.data,V.login(c.login.token),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.error(e.t0);case 13:a({email:"",password:""});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}();return Object(k.jsx)("main",{className:"flex-row justify-center mb-4",children:Object(k.jsx)("div",{className:"col-12 col-lg-10",children:Object(k.jsxs)("div",{className:"card",children:[Object(k.jsx)("h4",{className:"card-header bg-dark text-light p-2",children:"Login"}),Object(k.jsxs)("div",{className:"card-body",children:[d?Object(k.jsxs)("p",{children:["Success! You may now head"," ",Object(k.jsx)(y.b,{to:"/",children:"back to the homepage."})]}):Object(k.jsxs)("form",{onSubmit:m,children:[Object(k.jsx)("input",{className:"form-input",placeholder:"Your email",name:"email",type:"email",value:r.email,onChange:j}),Object(k.jsx)("input",{className:"form-input",placeholder:"******",name:"password",type:"password",value:r.password,onChange:j}),Object(k.jsx)("button",{className:"btn btn-block btn-primary",style:{cursor:"pointer"},type:"submit",children:"Submit"})]}),l&&Object(k.jsx)("div",{className:"my-3 p-3 bg-danger text-white",children:l.message})]})]})})})},te=function(e){var t=e.comments,n=void 0===t?[]:t;return n.length?Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)("h3",{className:"p-5 display-inline-block",style:{borderBottom:"1px dotted #1a1a1a"},children:"Comments"}),Object(k.jsx)("div",{className:"flex-row my-4",children:n&&n.map((function(e){return Object(k.jsx)("div",{className:"col-12 mb-3 pb-3",children:Object(k.jsxs)("div",{className:"p-3 bg-dark text-light",children:[Object(k.jsxs)("h5",{className:"card-header",children:[e.commentAuthor," reported"," ",Object(k.jsxs)("span",{style:{fontSize:"0.825rem"},children:["on ",e.createdAt]})]}),Object(k.jsx)("p",{className:"card-body",children:e.commentText})]})},e._id)}))})]}):Object(k.jsx)("h3",{children:"No Reports Yet"})},ne=function(e){var t=e.reportId,n=Object(b.useState)(""),r=Object(C.a)(n,2),a=r[0],c=r[1],s=Object(b.useState)(0),o=Object(C.a)(s,2),i=o[0],l=o[1],d=Object(P.a)(D),j=Object(C.a)(d,2),m=j[0],u=j[1].error,h=function(){var e=Object(A.a)(T.a.mark((function e(n){var r;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,e.next=4,m({variables:{reportId:t,commentText:a,commentAuthor:V.getProfile().data.username}});case 4:r=e.sent,r.data,c(""),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(k.jsxs)("div",{children:[Object(k.jsx)("h4",{children:"Do you want to report a lost pet?"}),V.loggedIn()?Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)("p",{className:"m-0 ".concat(280===i||u?"text-danger":""),children:["Character Count: ",i,"/280",u&&Object(k.jsx)("span",{className:"ml-2",children:u.message})]}),Object(k.jsxs)("form",{className:"flex-row justify-center justify-space-between-md align-center",onSubmit:h,children:[Object(k.jsx)("div",{className:"col-12 col-lg-9",children:Object(k.jsx)("textarea",{name:"commentText",placeholder:"Add your report...",value:a,className:"form-input w-100",style:{lineHeight:"1.5",resize:"vertical"},onChange:function(e){var t=e.target,n=t.name,r=t.value;"commentText"===n&&r.length<=280&&(c(r),l(r.length))}})}),Object(k.jsx)("div",{className:"col-12 col-lg-3",children:Object(k.jsx)("button",{className:"btn btn-primary btn-block py-3",type:"submit",children:"Add Report"})})]})]}):Object(k.jsxs)("p",{children:["You need to be logged in to view or report lost pets. Please"," ",Object(k.jsx)(y.b,{to:"/login",children:"login"})," or ",Object(k.jsx)(y.b,{to:"/signup",children:"signup."})]})]})},re=function(){var e=Object(N.h)().reportId,t=Object(w.a)(M,{variables:{reportId:e}}),n=t.loading,r=t.data,a=(null===r||void 0===r?void 0:r.report)||{};return n?Object(k.jsx)("div",{children:"Loading..."}):Object(k.jsxs)("div",{className:"my-3",children:[Object(k.jsxs)("h3",{className:"card-header bg-dark text-light p-2 m-0",children:[a.reportAuthor," ",Object(k.jsx)("br",{}),Object(k.jsxs)("span",{style:{fontSize:"1rem"},children:["had this report on ",a.createdAt]})]}),Object(k.jsx)("div",{className:"bg-light py-4",children:Object(k.jsx)("blockquote",{className:"p-4",style:{fontSize:"1.5rem",fontStyle:"italic",border:"2px dotted #1a1a1a",lineHeight:"1.5"},children:a.reportText})}),Object(k.jsxs)("div",{id:"wrapper",children:[Object(k.jsx)("div",{className:"m-3 p-4"}),Object(k.jsx)(W,{})]}),Object(k.jsx)("div",{className:"my-5",children:Object(k.jsx)(te,{comments:a.comments})}),Object(k.jsx)("div",{className:"m-3 p-4",style:{border:"1px dotted #1a1a1a"},children:Object(k.jsx)(ne,{reportId:a._id})})]})},ae=function(){var e=Object(N.h)().username,t=Object(w.a)(e?J:q,{variables:{username:e}}),n=t.loading,r=t.data,a=(null===r||void 0===r?void 0:r.me)||(null===r||void 0===r?void 0:r.user)||{};return V.loggedIn()&&V.getProfile().data.username===e?Object(k.jsx)(N.a,{to:"/me"}):n?Object(k.jsx)("div",{children:"Loading..."}):(null===a||void 0===a?void 0:a.username)?Object(k.jsx)("div",{children:Object(k.jsxs)("div",{className:"flex-row justify-center mb-3",children:[Object(k.jsxs)("h2",{className:"col-12 col-md-10 bg-dark text-light p-3 mb-5",children:["Viewing ",e?"".concat(a.username,"'s"):"your"," profile."]}),Object(k.jsx)("div",{className:"col-12 col-md-10 mb-5",children:Object(k.jsx)(S,{reports:a.reports,title:"".concat(a.username,"'s reports..."),showTitle:!1,showUsername:!1})}),!e&&Object(k.jsx)("div",{className:"col-12 col-md-10 mb-3 p-3",style:{border:"1px dotted #1a1a1a"},children:Object(k.jsx)(B,{})})]})}):Object(k.jsx)("h4",{children:"You need to be logged in to see this. Use the navigation links above to sign up or log in!"})},ce=function(){return Object(k.jsx)("header",{className:"bg-info text-light mb-4 py-3 flex-row align-center",children:Object(k.jsxs)("div",{className:"container flex-row justify-space-between-lg justify-center align-center",children:[Object(k.jsxs)("div",{children:[Object(k.jsx)(y.b,{className:"text-light",to:"/",children:Object(k.jsx)("h1",{className:"m-0",children:"Pet Fetch"})}),Object(k.jsx)("p",{className:"m-0",children:"Find your lost pet friend."})]}),Object(k.jsx)("div",{children:V.loggedIn()?Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)(y.b,{className:"btn btn-lg btn-info m-2",to:"/me",children:[V.getProfile().data.username,"'s profile"]}),Object(k.jsx)("button",{className:"btn btn-lg btn-light m-2",onClick:function(e){e.preventDefault(),V.logout()},children:"Logout"})]}):Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(y.b,{className:"btn btn-lg btn-info m-2",to:"/login",children:"Login"}),Object(k.jsx)(y.b,{className:"btn btn-lg btn-light m-2",to:"/signup",children:"Signup"})]})})]})})},se=function(){var e=Object(N.g)(),t=Object(N.f)();return Object(k.jsx)("footer",{className:"w-100 mt-auto bg-secondary p-4",children:Object(k.jsxs)("div",{className:"container text-center mb-5",children:["/"!==e.pathname&&Object(k.jsx)("button",{className:"btn btn-dark mb-3",onClick:function(){return t.goBack()},children:"\u2190 Go Back"}),Object(k.jsxs)("h4",{children:["Made with"," ",Object(k.jsx)("span",{className:"emoji",role:"img","aria-label":"heart","aria-hidden":"false",children:"\u2764\ufe0f"})," ","by the Pet Fetch team."]})]})})},oe=Object(x.a)({uri:"/graphql"}),ie=Object(f.a)((function(e,t){var n=t.headers,r=localStorage.getItem("id_token");return{headers:Object(p.a)(Object(p.a)({},n),{},{authorization:r?"Bearer ".concat(r):""})}})),le=new O.a({link:ie.concat(oe),cache:new g.a});var de=function(){return Object(k.jsx)(v.a,{client:le,children:Object(k.jsx)(y.a,{children:Object(k.jsxs)("div",{className:"flex-column justify-flex-start min-100-vh",children:[Object(k.jsx)(ce,{}),Object(k.jsxs)("div",{className:"container",children:[Object(k.jsx)(N.b,{exact:!0,path:"/",children:Object(k.jsx)(G,{})}),Object(k.jsx)(N.b,{exact:!0,path:"/login",children:Object(k.jsx)(ee,{})}),Object(k.jsx)(N.b,{exact:!0,path:"/signup",children:Object(k.jsx)(X,{})}),Object(k.jsx)(N.b,{exact:!0,path:"/me",children:Object(k.jsx)(ae,{})}),Object(k.jsx)(N.b,{exact:!0,path:"/profiles/:username",children:Object(k.jsx)(ae,{})}),Object(k.jsx)(N.b,{exact:!0,path:"/reports/:reportId",children:Object(k.jsx)(re,{})})]}),Object(k.jsx)(se,{})]})})})},je=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,141)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))};h.a.render(Object(k.jsx)(m.a.StrictMode,{children:Object(k.jsx)(de,{})}),document.getElementById("root")),je()}},[[126,1,2]]]);
//# sourceMappingURL=main.4936ff3b.chunk.js.map